{% extends 'base.html' %}
{% load filters %}
{% load static tz bootstrap_tags crispy_forms_tags %}
{% block page_title %}
    Submissions
{% endblock %}
{% block head_css %}
    <link rel="stylesheet" href="{% static 'css/ratings.css' %}" type="text/css">
{% endblock %}
{% block page_heading %}
    Entries for: {{ challenge.name|title }}
{% endblock %}
{% block main_content %}
    {% if submissions|length == 0 %}
        <p>There are no submissions for this challenge yet.</p>
    {% else %}
        {# Ratings input needs the csrf_token #}
        <form class="form-wrap" role="form" id="submit-rating-form">
            {% csrf_token %}
            <div id="carousel" class="carousel slide" data-ride="carousel">

                <div class="carousel-inner">
                    {% for item in submissions %}
                        <div class="carousel-item {% if forloop.counter == 1 %}active{% endif %}">

                            {% include 'aggregate_rating.html' %}
                            <h2>Title: {{ item.title|title }}</h2>
                            <img width="auto" height="100%" src="{{ item.image_file.url }}"
                                 alt="image for {{ item.title }}">
                            <div class="carousel-caption">
                                {# include rating input for this entry #}
                                {% include 'rating_form.html' %}

                                <p>Entry: {{ forloop.counter }} of {{ submissions|length }}</p>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                <a class="carousel-control-prev" href="#carousel" role="button" data-slide="prev">
                    <i aria-hidden="true" class="fas fa-lg fa-chevron-circle-left"></i>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carousel" role="button" data-slide="next">
                    <i aria-hidden="true" class="fas fa-lg fa-chevron-circle-right"></i>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </form>

    {% endif %}
    <script type="text/javascript" src="{% static 'js/rating.js' %}"></script>
{% endblock %}